
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
      <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      -->
      <title>lasso_lsqr_example</title>
      <meta name="generator" content="MATLAB 7.7">
      <meta name="date" content="2011-02-16">
      <meta name="m-file" content="lasso_lsqr_example"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head>
   <body>
      <div class="content">
         <h2>Contents</h2>
         <div>
            <ul>
               <li><a href="#2">Generate problem data</a></li>
               <li><a href="#3">Solve problem</a></li>
               <li><a href="#4">Reporting</a></li>
            </ul>
         </div><pre class="codeinput"><span class="comment">% L1-regularized least-squares example for sparse A</span>
</pre><h2>Generate problem data<a name="2"></a></h2><pre class="codeinput">randn(<span class="string">'seed'</span>, 0);
rand(<span class="string">'seed'</span>,0);

m  = 1000000;   <span class="comment">% number of examples</span>
n  = 10000;     <span class="comment">% number of features</span>
p1 = 0.001;     <span class="comment">% sparsity density of solution vector</span>
p2 = 0.0001;    <span class="comment">% sparsity density of A</span>

x0 = sprandn(n, 1, p1);
A = sprandn(m, n, p2);
b = A*x0 + 0.1*randn(m,1);

lambda_max = norm(A'*b, <span class="string">'inf'</span>);
lambda = 0.1*lambda_max;
</pre><h2>Solve problem<a name="3"></a></h2><pre class="codeinput">[x history] = lasso_lsqr(A, b, lambda, 1.0, 1.0);
</pre><pre class="codeoutput">iter	lsqr iters	    r norm	   eps pri	    s norm	  eps dual	 objective
  1	         9	    3.1869	    0.0419	    0.0000	    0.0419	   4938.93
  2	        15	    3.1585	    0.0416	    0.0000	    0.0735	   4939.07
  3	        21	    3.1304	    0.0413	    0.0000	    0.1048	   4939.29
  4	        26	    3.1025	    0.0410	    0.0000	    0.1358	   4939.60
  5	        31	    3.0749	    0.0407	    0.0000	    0.1665	   4939.99
  6	        36	    3.0475	    0.0405	    0.0000	    0.1970	   4940.46
  7	        41	    3.0204	    0.0402	    0.0000	    0.2272	   4941.00
  8	        46	    2.9935	    0.0399	    0.0000	    0.2571	   4941.63
  9	        51	    2.9670	    0.0397	    0.0000	    0.2868	   4942.33
 10	        56	    2.9406	    0.0394	    0.0000	    0.3162	   4943.09
 11	        61	    2.9145	    0.0391	    0.0000	    0.3454	   4943.93
 12	        66	    2.8887	    0.0389	    0.0000	    0.3742	   4944.84
 13	        71	    2.8631	    0.0386	    0.0000	    0.4029	   4945.81
 14	        76	    2.5042	    0.0384	    0.7158	    0.4273	   4963.24
 15	        81	    1.9661	    0.0382	    1.1052	    0.4433	   4999.49
 16	        86	    1.7715	    0.0381	    0.8142	    0.4553	   5018.68
 17	        91	    1.7540	    0.0380	    0.0071	    0.4675	   5019.23
 18	        96	    1.7368	    0.0379	    0.0001	    0.4799	   5019.80
 19	       101	    1.7198	    0.0378	    0.0000	    0.4925	   5020.40
 20	       106	    1.7029	    0.0377	    0.0000	    0.5053	   5021.02
 21	       111	    1.6862	    0.0376	    0.0000	    0.5182	   5021.66
 22	       116	    1.6094	    0.0375	    0.1119	    0.5306	   5024.89
 23	       121	    1.3672	    0.0374	    0.8200	    0.5396	   5044.29
 24	       126	    1.3539	    0.0374	    0.0083	    0.5487	   5044.77
 25	       131	    1.3408	    0.0373	    0.0001	    0.5578	   5045.26
 26	       136	    1.3278	    0.0373	    0.0000	    0.5671	   5045.76
 27	       141	    1.3150	    0.0372	    0.0000	    0.5764	   5046.27
 28	       146	    1.3023	    0.0371	    0.0000	    0.5857	   5046.80
 29	       151	    1.2897	    0.0371	    0.0000	    0.5951	   5047.33
 30	       156	    1.1497	    0.0370	    0.2912	    0.6035	   5054.55
 31	       161	    1.0723	    0.0370	    0.3850	    0.6103	   5063.80
 32	       166	    1.0616	    0.0369	    0.0034	    0.6172	   5064.22
 33	       171	    1.0511	    0.0369	    0.0001	    0.6242	   5064.65
 34	       176	    1.0406	    0.0369	    0.0000	    0.6312	   5065.08
 35	       181	    1.0303	    0.0368	    0.0000	    0.6382	   5065.52
 36	       186	    1.0201	    0.0368	    0.0000	    0.6452	   5065.97
 37	       191	    1.0100	    0.0367	    0.0000	    0.6522	   5066.42
 38	       196	    0.9029	    0.0367	    0.2264	    0.6585	   5072.07
 39	       201	    0.8443	    0.0367	    0.2946	    0.6637	   5079.19
 40	       206	    0.8354	    0.0367	    0.0024	    0.6689	   5079.56
 41	       211	    0.8266	    0.0366	    0.0000	    0.6741	   5079.93
 42	       216	    0.8179	    0.0366	    0.0000	    0.6793	   5080.30
 43	       221	    0.8093	    0.0366	    0.0000	    0.6846	   5080.68
 44	       225	    0.8008	    0.0366	    0.0000	    0.6898	   5081.06
 45	       229	    0.7923	    0.0365	    0.0000	    0.6950	   5081.44
 46	       233	    0.7011	    0.0365	    0.2137	    0.6995	   5086.72
 47	       237	    0.6701	    0.0365	    0.1816	    0.7035	   5091.16
 48	       241	    0.6630	    0.0365	    0.0019	    0.7074	   5091.46
 49	       245	    0.6560	    0.0365	    0.0001	    0.7113	   5091.75
 50	       249	    0.6491	    0.0364	    0.0000	    0.7152	   5092.05
 51	       253	    0.6422	    0.0364	    0.0000	    0.7191	   5092.35
 52	       257	    0.6354	    0.0364	    0.0000	    0.7230	   5092.65
 53	       261	    0.6287	    0.0364	    0.0000	    0.7269	   5092.95
 54	       265	    0.6221	    0.0364	    0.0000	    0.7308	   5093.25
 55	       269	    0.6155	    0.0364	    0.0000	    0.7346	   5093.55
 56	       273	    0.6091	    0.0363	    0.0000	    0.7385	   5093.85
 57	       277	    0.6027	    0.0363	    0.0000	    0.7423	   5094.16
 58	       281	    0.5963	    0.0363	    0.0000	    0.7462	   5094.46
 59	       285	    0.5901	    0.0363	    0.0000	    0.7500	   5094.76
 60	       289	    0.5839	    0.0363	    0.0000	    0.7538	   5095.07
 61	       293	    0.5778	    0.0363	    0.0000	    0.7576	   5095.37
 62	       297	    0.5717	    0.0363	    0.0000	    0.7614	   5095.67
 63	       301	    0.5658	    0.0362	    0.0000	    0.7652	   5095.98
 64	       305	    0.5598	    0.0362	    0.0000	    0.7689	   5096.28
 65	       309	    0.5540	    0.0362	    0.0000	    0.7726	   5096.59
 66	       313	    0.5482	    0.0362	    0.0000	    0.7763	   5096.89
 67	       317	    0.5425	    0.0362	    0.0000	    0.7800	   5097.19
 68	       321	    0.5369	    0.0362	    0.0000	    0.7837	   5097.50
 69	       325	    0.5313	    0.0362	    0.0000	    0.7874	   5097.80
 70	       329	    0.5258	    0.0362	    0.0000	    0.7910	   5098.10
 71	       333	    0.5203	    0.0362	    0.0000	    0.7946	   5098.41
 72	       337	    0.5149	    0.0361	    0.0000	    0.7982	   5098.71
 73	       341	    0.5096	    0.0361	    0.0000	    0.8018	   5099.01
 74	       345	    0.5043	    0.0361	    0.0000	    0.8053	   5099.31
 75	       349	    0.4991	    0.0361	    0.0000	    0.8089	   5099.61
 76	       353	    0.4939	    0.0361	    0.0000	    0.8124	   5099.91
 77	       357	    0.4888	    0.0361	    0.0000	    0.8159	   5100.20
 78	       361	    0.4837	    0.0361	    0.0000	    0.8193	   5100.50
 79	       365	    0.4788	    0.0361	    0.0000	    0.8228	   5100.80
 80	       369	    0.4738	    0.0361	    0.0000	    0.8262	   5101.09
 81	       373	    0.4689	    0.0361	    0.0000	    0.8296	   5101.39
 82	       377	    0.4641	    0.0361	    0.0000	    0.8330	   5101.68
 83	       381	    0.4593	    0.0360	    0.0000	    0.8363	   5101.98
 84	       385	    0.4546	    0.0360	    0.0000	    0.8396	   5102.27
 85	       389	    0.4500	    0.0360	    0.0000	    0.8429	   5102.56
 86	       393	    0.4453	    0.0360	    0.0000	    0.8462	   5102.85
 87	       397	    0.4408	    0.0360	    0.0000	    0.8495	   5103.14
 88	       401	    0.4363	    0.0360	    0.0000	    0.8527	   5103.42
 89	       405	    0.4318	    0.0360	    0.0000	    0.8559	   5103.71
 90	       409	    0.4274	    0.0360	    0.0000	    0.8591	   5103.99
 91	       413	    0.4230	    0.0360	    0.0000	    0.8622	   5104.28
 92	       417	    0.4187	    0.0360	    0.0000	    0.8654	   5104.56
 93	       421	    0.4144	    0.0360	    0.0000	    0.8685	   5104.84
 94	       425	    0.4102	    0.0360	    0.0000	    0.8716	   5105.12
 95	       429	    0.4060	    0.0360	    0.0000	    0.8747	   5105.40
 96	       433	    0.4019	    0.0359	    0.0000	    0.8777	   5105.68
 97	       437	    0.3978	    0.0359	    0.0000	    0.8807	   5105.95
 98	       441	    0.3938	    0.0359	    0.0000	    0.8837	   5106.23
 99	       445	    0.3898	    0.0359	    0.0000	    0.8867	   5106.50
100	       449	    0.3858	    0.0359	    0.0000	    0.8896	   5106.77
101	       453	    0.3819	    0.0359	    0.0000	    0.8925	   5107.04
102	       457	    0.3781	    0.0359	    0.0000	    0.8954	   5107.31
103	       461	    0.3742	    0.0359	    0.0000	    0.8983	   5107.58
104	       465	    0.3705	    0.0359	    0.0000	    0.9012	   5107.84
105	       469	    0.3667	    0.0359	    0.0000	    0.9040	   5108.11
106	       473	    0.3630	    0.0359	    0.0000	    0.9068	   5108.37
107	       477	    0.3594	    0.0359	    0.0000	    0.9096	   5108.63
108	       481	    0.3557	    0.0359	    0.0000	    0.9123	   5108.89
109	       485	    0.3522	    0.0359	    0.0000	    0.9151	   5109.15
110	       489	    0.3486	    0.0359	    0.0000	    0.9178	   5109.40
111	       493	    0.3451	    0.0359	    0.0000	    0.9205	   5109.66
112	       497	    0.3417	    0.0359	    0.0000	    0.9231	   5109.91
113	       501	    0.3382	    0.0359	    0.0000	    0.9258	   5110.16
114	       505	    0.3348	    0.0359	    0.0000	    0.9284	   5110.41
115	       509	    0.3315	    0.0359	    0.0000	    0.9310	   5110.66
116	       513	    0.3282	    0.0358	    0.0000	    0.9336	   5110.91
117	       517	    0.3249	    0.0358	    0.0000	    0.9361	   5111.16
118	       521	    0.3216	    0.0358	    0.0000	    0.9387	   5111.40
119	       525	    0.3184	    0.0358	    0.0000	    0.9412	   5111.64
120	       529	    0.3153	    0.0358	    0.0000	    0.9437	   5111.88
121	       533	    0.3121	    0.0358	    0.0000	    0.9461	   5112.12
122	       537	    0.3067	    0.0358	    0.0090	    0.9486	   5112.57
123	       541	    0.2948	    0.0358	    0.0729	    0.9508	   5114.47
124	       545	    0.2919	    0.0358	    0.0009	    0.9530	   5114.68
125	       549	    0.2891	    0.0358	    0.0000	    0.9552	   5114.89
126	       553	    0.2862	    0.0358	    0.0000	    0.9574	   5115.10
127	       557	    0.2834	    0.0358	    0.0000	    0.9595	   5115.31
128	       561	    0.2807	    0.0358	    0.0000	    0.9616	   5115.51
129	       565	    0.2779	    0.0358	    0.0000	    0.9638	   5115.72
130	       569	    0.2752	    0.0358	    0.0000	    0.9659	   5115.92
131	       573	    0.2725	    0.0358	    0.0000	    0.9679	   5116.13
132	       577	    0.2699	    0.0358	    0.0000	    0.9700	   5116.33
133	       581	    0.2673	    0.0358	    0.0000	    0.9720	   5116.53
134	       584	    0.2647	    0.0358	    0.0000	    0.9741	   5116.72
135	       587	    0.2621	    0.0358	    0.0000	    0.9761	   5116.92
136	       590	    0.2596	    0.0358	    0.0000	    0.9781	   5117.12
137	       593	    0.2570	    0.0358	    0.0000	    0.9801	   5117.31
138	       596	    0.2545	    0.0358	    0.0000	    0.9820	   5117.50
139	       599	    0.2521	    0.0358	    0.0000	    0.9840	   5117.69
140	       602	    0.2496	    0.0358	    0.0000	    0.9859	   5117.88
141	       605	    0.2472	    0.0358	    0.0000	    0.9878	   5118.07
142	       608	    0.2448	    0.0358	    0.0000	    0.9897	   5118.26
143	       611	    0.2425	    0.0358	    0.0000	    0.9916	   5118.44
144	       614	    0.2401	    0.0358	    0.0000	    0.9934	   5118.63
145	       617	    0.2378	    0.0358	    0.0000	    0.9953	   5118.81
146	       620	    0.2355	    0.0358	    0.0000	    0.9971	   5118.99
147	       623	    0.2333	    0.0358	    0.0000	    0.9989	   5119.17
148	       626	    0.2310	    0.0358	    0.0000	    1.0007	   5119.35
149	       629	    0.2288	    0.0358	    0.0000	    1.0025	   5119.53
150	       632	    0.2266	    0.0358	    0.0000	    1.0042	   5119.71
151	       635	    0.2244	    0.0358	    0.0000	    1.0060	   5119.88
152	       638	    0.2223	    0.0358	    0.0000	    1.0077	   5120.05
153	       641	    0.2201	    0.0358	    0.0000	    1.0094	   5120.23
154	       644	    0.2180	    0.0357	    0.0000	    1.0111	   5120.40
155	       647	    0.2159	    0.0357	    0.0000	    1.0128	   5120.57
156	       650	    0.2139	    0.0357	    0.0000	    1.0145	   5120.74
157	       653	    0.2118	    0.0357	    0.0000	    1.0161	   5120.90
158	       656	    0.2098	    0.0357	    0.0000	    1.0178	   5121.07
159	       659	    0.2078	    0.0357	    0.0000	    1.0194	   5121.23
160	       662	    0.2058	    0.0357	    0.0000	    1.0210	   5121.40
161	       665	    0.2039	    0.0357	    0.0000	    1.0226	   5121.56
162	       668	    0.2019	    0.0357	    0.0000	    1.0242	   5121.72
163	       671	    0.2000	    0.0357	    0.0000	    1.0258	   5121.88
164	       674	    0.1981	    0.0357	    0.0000	    1.0273	   5122.04
165	       677	    0.1962	    0.0357	    0.0000	    1.0289	   5122.19
166	       680	    0.1943	    0.0357	    0.0000	    1.0304	   5122.35
167	       683	    0.1925	    0.0357	    0.0000	    1.0319	   5122.50
168	       686	    0.1907	    0.0357	    0.0000	    1.0334	   5122.65
169	       689	    0.1889	    0.0357	    0.0000	    1.0349	   5122.81
170	       692	    0.1871	    0.0357	    0.0000	    1.0364	   5122.96
171	       695	    0.1853	    0.0357	    0.0000	    1.0378	   5123.11
172	       698	    0.1836	    0.0357	    0.0000	    1.0393	   5123.25
173	       701	    0.1818	    0.0357	    0.0000	    1.0407	   5123.40
174	       704	    0.1801	    0.0357	    0.0000	    1.0421	   5123.55
175	       707	    0.1784	    0.0357	    0.0000	    1.0435	   5123.69
176	       710	    0.1767	    0.0357	    0.0000	    1.0449	   5123.83
177	       713	    0.1751	    0.0357	    0.0000	    1.0463	   5123.98
178	       716	    0.1734	    0.0357	    0.0000	    1.0477	   5124.12
179	       719	    0.1718	    0.0357	    0.0000	    1.0490	   5124.26
180	       722	    0.1702	    0.0357	    0.0000	    1.0504	   5124.40
181	       725	    0.1686	    0.0357	    0.0000	    1.0517	   5124.53
182	       728	    0.1670	    0.0357	    0.0000	    1.0531	   5124.67
183	       731	    0.1654	    0.0357	    0.0000	    1.0544	   5124.81
184	       734	    0.1639	    0.0357	    0.0000	    1.0557	   5124.94
185	       737	    0.1623	    0.0357	    0.0000	    1.0569	   5125.07
186	       740	    0.1608	    0.0357	    0.0000	    1.0582	   5125.21
187	       743	    0.1593	    0.0357	    0.0000	    1.0595	   5125.34
188	       746	    0.1578	    0.0357	    0.0000	    1.0607	   5125.47
189	       749	    0.1563	    0.0357	    0.0000	    1.0620	   5125.59
190	       752	    0.1549	    0.0357	    0.0000	    1.0632	   5125.72
191	       755	    0.1534	    0.0357	    0.0000	    1.0644	   5125.85
192	       758	    0.1520	    0.0357	    0.0000	    1.0656	   5125.97
193	       761	    0.1506	    0.0357	    0.0000	    1.0668	   5126.10
194	       764	    0.1492	    0.0357	    0.0000	    1.0680	   5126.22
195	       767	    0.1478	    0.0357	    0.0000	    1.0692	   5126.34
196	       770	    0.1464	    0.0357	    0.0000	    1.0703	   5126.47
197	       773	    0.1451	    0.0357	    0.0000	    1.0715	   5126.59
198	       776	    0.1437	    0.0357	    0.0000	    1.0726	   5126.70
199	       779	    0.1424	    0.0357	    0.0000	    1.0738	   5126.82
200	       782	    0.1411	    0.0357	    0.0000	    1.0749	   5126.94
201	       785	    0.1398	    0.0357	    0.0000	    1.0760	   5127.06
202	       788	    0.1385	    0.0357	    0.0000	    1.0771	   5127.17
203	       791	    0.1372	    0.0357	    0.0000	    1.0782	   5127.29
204	       794	    0.1359	    0.0357	    0.0000	    1.0793	   5127.40
205	       797	    0.1347	    0.0357	    0.0000	    1.0804	   5127.51
206	       800	    0.1334	    0.0357	    0.0000	    1.0814	   5127.62
207	       803	    0.1322	    0.0357	    0.0000	    1.0825	   5127.73
208	       806	    0.1310	    0.0357	    0.0000	    1.0835	   5127.84
209	       809	    0.1298	    0.0357	    0.0000	    1.0845	   5127.95
210	       812	    0.1286	    0.0357	    0.0000	    1.0856	   5128.06
211	       815	    0.1274	    0.0357	    0.0000	    1.0866	   5128.17
212	       818	    0.1262	    0.0357	    0.0000	    1.0876	   5128.27
213	       821	    0.1250	    0.0357	    0.0000	    1.0886	   5128.38
214	       824	    0.1239	    0.0357	    0.0000	    1.0896	   5128.48
215	       827	    0.1228	    0.0357	    0.0000	    1.0905	   5128.58
216	       830	    0.1216	    0.0357	    0.0000	    1.0915	   5128.68
217	       833	    0.1205	    0.0357	    0.0000	    1.0925	   5128.79
218	       836	    0.1194	    0.0357	    0.0000	    1.0934	   5128.89
219	       839	    0.1183	    0.0357	    0.0000	    1.0944	   5128.99
220	       842	    0.1172	    0.0357	    0.0000	    1.0953	   5129.08
221	       845	    0.1162	    0.0357	    0.0000	    1.0962	   5129.18
222	       848	    0.1151	    0.0357	    0.0000	    1.0971	   5129.28
223	       851	    0.1140	    0.0357	    0.0000	    1.0980	   5129.37
224	       854	    0.1130	    0.0357	    0.0000	    1.0989	   5129.47
225	       857	    0.1120	    0.0357	    0.0000	    1.0998	   5129.56
226	       860	    0.1109	    0.0357	    0.0000	    1.1007	   5129.66
227	       863	    0.1099	    0.0357	    0.0000	    1.1016	   5129.75
228	       866	    0.1089	    0.0357	    0.0000	    1.1025	   5129.84
229	       869	    0.1079	    0.0357	    0.0000	    1.1033	   5129.93
230	       872	    0.1070	    0.0357	    0.0000	    1.1042	   5130.02
231	       875	    0.1060	    0.0357	    0.0000	    1.1050	   5130.11
232	       878	    0.1050	    0.0357	    0.0000	    1.1059	   5130.20
233	       881	    0.1041	    0.0357	    0.0000	    1.1067	   5130.29
234	       884	    0.1031	    0.0357	    0.0000	    1.1075	   5130.38
235	       887	    0.1022	    0.0357	    0.0000	    1.1083	   5130.46
236	       890	    0.1013	    0.0357	    0.0000	    1.1091	   5130.55
237	       893	    0.1003	    0.0357	    0.0000	    1.1099	   5130.63
238	       896	    0.0994	    0.0357	    0.0000	    1.1107	   5130.72
239	       899	    0.0985	    0.0357	    0.0000	    1.1115	   5130.80
240	       902	    0.0976	    0.0357	    0.0000	    1.1123	   5130.88
241	       905	    0.0968	    0.0357	    0.0000	    1.1131	   5130.96
242	       908	    0.0959	    0.0357	    0.0000	    1.1138	   5131.05
243	       911	    0.0950	    0.0357	    0.0000	    1.1146	   5131.13
244	       914	    0.0942	    0.0357	    0.0000	    1.1153	   5131.21
245	       917	    0.0933	    0.0357	    0.0000	    1.1161	   5131.28
246	       920	    0.0925	    0.0357	    0.0000	    1.1168	   5131.36
247	       923	    0.0916	    0.0357	    0.0000	    1.1175	   5131.44
248	       926	    0.0908	    0.0357	    0.0000	    1.1182	   5131.52
249	       929	    0.0900	    0.0357	    0.0000	    1.1190	   5131.59
250	       932	    0.0892	    0.0357	    0.0000	    1.1197	   5131.67
251	       935	    0.0884	    0.0357	    0.0000	    1.1204	   5131.74
252	       938	    0.0876	    0.0357	    0.0000	    1.1211	   5131.82
253	       941	    0.0868	    0.0357	    0.0000	    1.1218	   5131.89
254	       944	    0.0860	    0.0357	    0.0000	    1.1224	   5131.96
255	       947	    0.0853	    0.0357	    0.0000	    1.1231	   5132.04
256	       950	    0.0845	    0.0357	    0.0000	    1.1238	   5132.11
257	       953	    0.0837	    0.0357	    0.0000	    1.1245	   5132.18
258	       956	    0.0830	    0.0357	    0.0000	    1.1251	   5132.25
259	       959	    0.0822	    0.0357	    0.0000	    1.1258	   5132.32
260	       962	    0.0815	    0.0357	    0.0000	    1.1264	   5132.39
261	       965	    0.0808	    0.0357	    0.0000	    1.1271	   5132.46
262	       968	    0.0801	    0.0357	    0.0000	    1.1277	   5132.52
263	       971	    0.0793	    0.0357	    0.0000	    1.1283	   5132.59
264	       973	    0.0786	    0.0357	    0.0000	    1.1289	   5132.66
265	       976	    0.0779	    0.0357	    0.0000	    1.1296	   5132.72
266	       978	    0.0772	    0.0357	    0.0000	    1.1302	   5132.79
267	       981	    0.0766	    0.0357	    0.0000	    1.1308	   5132.85
268	       983	    0.0759	    0.0357	    0.0000	    1.1314	   5132.92
269	       986	    0.0752	    0.0357	    0.0000	    1.1320	   5132.98
270	       988	    0.0745	    0.0357	    0.0000	    1.1326	   5133.04
271	       990	    0.0739	    0.0357	    0.0000	    1.1331	   5133.11
272	       992	    0.0732	    0.0357	    0.0000	    1.1337	   5133.17
273	       994	    0.0726	    0.0357	    0.0000	    1.1343	   5133.23
274	       996	    0.0719	    0.0357	    0.0000	    1.1349	   5133.29
275	       998	    0.0713	    0.0357	    0.0000	    1.1354	   5133.35
276	      1000	    0.0707	    0.0357	    0.0000	    1.1360	   5133.41
277	      1002	    0.0700	    0.0357	    0.0000	    1.1365	   5133.47
278	      1004	    0.0694	    0.0357	    0.0000	    1.1371	   5133.53
279	      1006	    0.0688	    0.0357	    0.0000	    1.1376	   5133.59
280	      1008	    0.0682	    0.0357	    0.0000	    1.1382	   5133.64
281	      1010	    0.0676	    0.0357	    0.0000	    1.1387	   5133.70
282	      1012	    0.0670	    0.0357	    0.0000	    1.1392	   5133.76
283	      1014	    0.0664	    0.0357	    0.0000	    1.1398	   5133.81
284	      1016	    0.0658	    0.0357	    0.0000	    1.1403	   5133.87
285	      1018	    0.0652	    0.0357	    0.0000	    1.1408	   5133.92
286	      1020	    0.0647	    0.0357	    0.0000	    1.1413	   5133.98
287	      1022	    0.0641	    0.0357	    0.0000	    1.1418	   5134.03
288	      1024	    0.0635	    0.0357	    0.0000	    1.1423	   5134.09
289	      1026	    0.0630	    0.0357	    0.0000	    1.1428	   5134.14
290	      1028	    0.0624	    0.0357	    0.0000	    1.1433	   5134.19
291	      1030	    0.0619	    0.0357	    0.0000	    1.1438	   5134.24
292	      1032	    0.0613	    0.0357	    0.0000	    1.1443	   5134.30
293	      1034	    0.0608	    0.0357	    0.0000	    1.1447	   5134.35
294	      1036	    0.0602	    0.0357	    0.0000	    1.1452	   5134.40
295	      1038	    0.0597	    0.0357	    0.0000	    1.1457	   5134.45
296	      1040	    0.0592	    0.0357	    0.0000	    1.1462	   5134.50
297	      1042	    0.0587	    0.0357	    0.0000	    1.1466	   5134.55
298	      1044	    0.0582	    0.0357	    0.0000	    1.1471	   5134.60
299	      1046	    0.0577	    0.0357	    0.0000	    1.1475	   5134.64
300	      1048	    0.0571	    0.0357	    0.0000	    1.1480	   5134.69
301	      1050	    0.0566	    0.0357	    0.0000	    1.1484	   5134.74
302	      1052	    0.0562	    0.0357	    0.0000	    1.1489	   5134.79
303	      1054	    0.0557	    0.0357	    0.0000	    1.1493	   5134.83
304	      1056	    0.0552	    0.0357	    0.0000	    1.1497	   5134.88
305	      1058	    0.0547	    0.0357	    0.0000	    1.1502	   5134.93
306	      1060	    0.0542	    0.0357	    0.0000	    1.1506	   5134.97
307	      1062	    0.0537	    0.0357	    0.0000	    1.1510	   5135.02
308	      1064	    0.0533	    0.0357	    0.0000	    1.1514	   5135.06
309	      1066	    0.0528	    0.0357	    0.0000	    1.1518	   5135.11
310	      1068	    0.0524	    0.0357	    0.0000	    1.1522	   5135.15
311	      1070	    0.0519	    0.0357	    0.0000	    1.1526	   5135.19
312	      1072	    0.0514	    0.0357	    0.0000	    1.1530	   5135.24
313	      1074	    0.0510	    0.0357	    0.0000	    1.1534	   5135.28
314	      1076	    0.0506	    0.0357	    0.0000	    1.1538	   5135.32
315	      1078	    0.0501	    0.0357	    0.0000	    1.1542	   5135.36
316	      1080	    0.0497	    0.0357	    0.0000	    1.1546	   5135.40
317	      1082	    0.0493	    0.0357	    0.0000	    1.1550	   5135.44
318	      1084	    0.0488	    0.0357	    0.0000	    1.1554	   5135.49
319	      1086	    0.0484	    0.0357	    0.0000	    1.1558	   5135.53
320	      1088	    0.0480	    0.0357	    0.0000	    1.1561	   5135.57
321	      1090	    0.0476	    0.0357	    0.0000	    1.1565	   5135.61
322	      1092	    0.0472	    0.0357	    0.0000	    1.1569	   5135.65
323	      1094	    0.0468	    0.0357	    0.0000	    1.1572	   5135.68
324	      1096	    0.0463	    0.0357	    0.0000	    1.1576	   5135.72
325	      1098	    0.0459	    0.0357	    0.0000	    1.1580	   5135.76
326	      1100	    0.0456	    0.0357	    0.0000	    1.1583	   5135.80
327	      1102	    0.0452	    0.0357	    0.0000	    1.1587	   5135.84
328	      1104	    0.0448	    0.0357	    0.0000	    1.1590	   5135.87
329	      1106	    0.0444	    0.0357	    0.0000	    1.1594	   5135.91
330	      1108	    0.0440	    0.0357	    0.0000	    1.1597	   5135.95
331	      1110	    0.0436	    0.0357	    0.0000	    1.1600	   5135.98
332	      1112	    0.0432	    0.0357	    0.0000	    1.1604	   5136.02
333	      1114	    0.0429	    0.0357	    0.0000	    1.1607	   5136.05
334	      1116	    0.0425	    0.0357	    0.0000	    1.1610	   5136.09
335	      1118	    0.0421	    0.0357	    0.0000	    1.1614	   5136.12
336	      1120	    0.0418	    0.0357	    0.0000	    1.1617	   5136.16
337	      1122	    0.0414	    0.0357	    0.0000	    1.1620	   5136.19
338	      1124	    0.0411	    0.0357	    0.0000	    1.1623	   5136.23
339	      1126	    0.0407	    0.0357	    0.0000	    1.1626	   5136.26
340	      1128	    0.0404	    0.0357	    0.0000	    1.1629	   5136.29
341	      1130	    0.0400	    0.0357	    0.0000	    1.1633	   5136.33
342	      1132	    0.0397	    0.0357	    0.0000	    1.1636	   5136.36
343	      1134	    0.0393	    0.0357	    0.0000	    1.1639	   5136.39
344	      1136	    0.0390	    0.0357	    0.0000	    1.1642	   5136.42
345	      1138	    0.0387	    0.0357	    0.0000	    1.1645	   5136.46
346	      1140	    0.0383	    0.0357	    0.0000	    1.1648	   5136.49
347	      1142	    0.0380	    0.0357	    0.0000	    1.1650	   5136.52
348	      1144	    0.0377	    0.0357	    0.0000	    1.1653	   5136.55
349	      1146	    0.0374	    0.0357	    0.0000	    1.1656	   5136.58
350	      1148	    0.0370	    0.0357	    0.0000	    1.1659	   5136.61
351	      1150	    0.0367	    0.0357	    0.0000	    1.1662	   5136.64
352	      1152	    0.0364	    0.0357	    0.0000	    1.1665	   5136.67
353	      1154	    0.0361	    0.0357	    0.0000	    1.1668	   5136.70
354	      1156	    0.0358	    0.0357	    0.0000	    1.1670	   5136.73
355	      1158	    0.0355	    0.0357	    0.0000	    1.1673	   5136.76
Elapsed time is 163.604215 seconds.
</pre><h2>Reporting<a name="4"></a></h2><pre class="codeinput">K = length(history.objval);

h = figure;
plot(1:K, history.objval, <span class="string">'k'</span>, <span class="string">'MarkerSize'</span>, 10, <span class="string">'LineWidth'</span>, 2);
ylabel(<span class="string">'f(x^k) + g(z^k)'</span>); xlabel(<span class="string">'iter (k)'</span>);

g = figure;
subplot(2,1,1);
semilogy(1:K, max(1e-8, history.r_norm), <span class="string">'k'</span>, <span class="keyword">...</span>
    1:K, history.eps_pri, <span class="string">'k--'</span>,  <span class="string">'LineWidth'</span>, 2);
ylabel(<span class="string">'||r||_2'</span>);

subplot(2,1,2);
semilogy(1:K, max(1e-8, history.s_norm), <span class="string">'k'</span>, <span class="keyword">...</span>
    1:K, history.eps_dual, <span class="string">'k--'</span>, <span class="string">'LineWidth'</span>, 2);
ylabel(<span class="string">'||s||_2'</span>); xlabel(<span class="string">'iter (k)'</span>);
</pre><img vspace="5" hspace="5" src="lasso_lsqr_example_01.png" alt=""> <img vspace="5" hspace="5" src="lasso_lsqr_example_02.png" alt=""> <p class="footer"><br>
            Published with MATLAB&reg; 7.7<br></p>
      </div>
      <!--
##### SOURCE BEGIN #####
% L1-regularized least-squares example for sparse A

%% Generate problem data

randn('seed', 0);
rand('seed',0);

m  = 1000000;   % number of examples
n  = 10000;     % number of features
p1 = 0.001;     % sparsity density of solution vector 
p2 = 0.0001;    % sparsity density of A

x0 = sprandn(n, 1, p1);
A = sprandn(m, n, p2);
b = A*x0 + 0.1*randn(m,1);

lambda_max = norm(A'*b, 'inf');
lambda = 0.1*lambda_max; 

%% Solve problem

[x history] = lasso_lsqr(A, b, lambda, 1.0, 1.0);

%% Reporting
K = length(history.objval);                                                                                                        

h = figure;
plot(1:K, history.objval, 'k', 'MarkerSize', 10, 'LineWidth', 2); 
ylabel('f(x^k) + g(z^k)'); xlabel('iter (k)');

g = figure;
subplot(2,1,1);                                                                                                                    
semilogy(1:K, max(1e-8, history.r_norm), 'k', ...
    1:K, history.eps_pri, 'kREPLACE_WITH_DASH_DASH',  'LineWidth', 2); 
ylabel('||r||_2'); 

subplot(2,1,2);                                                                                                                    
semilogy(1:K, max(1e-8, history.s_norm), 'k', ...
    1:K, history.eps_dual, 'kREPLACE_WITH_DASH_DASH', 'LineWidth', 2);   
ylabel('||s||_2'); xlabel('iter (k)'); 

##### SOURCE END #####
-->
   </body>
</html>